(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/rectificationTaskDetail/rectificationTaskDetail"],{"4c64":function(t,e,i){},"775f":function(t,e,i){"use strict";i.r(e);var a=i("fb4c"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},"99f3":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},c4f6:function(t,e,i){"use strict";i.r(e);var a=i("99f3"),n=i("775f");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("dbb3");var s=i("2877"),c=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"57ef3104",null);e["default"]=c.exports},dbb3:function(t,e,i){"use strict";var a=i("4c64"),n=i.n(a);n.a},fb4c:function(t,e,i){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(i("c0ea")),o=c(i("2a75")),s=i("196c");function c(t){return t&&t.__esModule?t:{default:t}}var r=function(){return i.e("components/createWaterMark/createWaterMark").then(i.bind(null,"5cfc"))},u={data:function(){return{pictures:[],rectificationBeforeDesc:"",longitude:"",latitude:"",imgUrl:"",taskDetail:{longitude:"",latitude:"",taskName:"",id:""},covers:[],circles:[],controls:[]}},components:{waterMark:r},onReady:function(){var e=t.createMapContext("locationMap"),i=e.$getAppMap();i.showUserLocation(!0),this.taskDetail=o.default.taskInfo;var a="";a=this.taskDetail.wryLongitude?s.mapTool.wgs84togcj02(this.taskDetail.wryLongitude,this.taskDetail.wryLatitude):s.mapTool.wgs84togcj02(t.getStorageSync("userLocation").longitude,t.getStorageSync("userLocation").latitude),this.longitude=a[0],this.latitude=a[1],this.userInfo=t.getStorageSync("userInfo");var n=t.getSystemInfoSync().screenWidth,c=(t.getSystemInfoSync().windowHeight,n/750);this.taskDetail.wryLongitude&&(this.controls=[{id:"toNavigation",position:{width:83*c,height:83*c,left:647*c,top:20*c},iconPath:"/static/images/icon_navigation.png",clickable:!0}],this.covers=[{id:"person1",latitude:a[1],longitude:a[0],iconPath:"../../static/images/dingwei.png",label:{content:this.taskDetail.address,color:"#5087FB"}}])},onLoad:function(t){},methods:{delPicture:function(t){var e=this.pictures;e.splice(t,1),this.pictures=e},getPhotoUrl:function(t){this.imgUrl="",this.pictures.push(t)},getDistance:function(){var e=this;if(this.taskDetail.wryLongitude){var i=new plus.maps.Point(t.getStorageSync("userLocation").longitude,t.getStorageSync("userLocation").latitude),n=new plus.maps.Point(this.taskDetail.wryLongitude,this.taskDetail.wryLatitude);plus.maps.Map.calculateDistance(i,n,function(i){i.distance>e.taskDetail.distanceLimit&&1==e.taskDetail.mustInRange?(console.log(a("this.pictures.length"," at pages\\rectificationTaskDetail\\rectificationTaskDetail.vue:140")),t.showToast({icon:"none",title:"距离任务地点太远，无法完成！"})):e.confirm()})}else t.showToast({icon:"none",title:"污染源位置信息不完整，请联系工作人员！"})},bindControltap:function(t){"toNavigation"==t.controlId&&this.toNavigation()},previewImage:function(e,i){t.previewImage({current:i,urls:e,fail:function(t){console.log(a(t," at pages\\rectificationTaskDetail\\rectificationTaskDetail.vue:161"))}})},toNavigation:function(){o.default.toNavigation(this.taskDetail.wryLongitude,this.taskDetail.wryLatitude)},takingPictures:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(t){e.imgUrl=t.tempFilePaths[0]}})},getImgUrl:function(t){var e=this;o.default.uploadFile(n.default.UPLOAD_UPLOAD,t,function(t){console.log(a(t," at pages\\rectificationTaskDetail\\rectificationTaskDetail.vue:183")),t=JSON.parse(t),console.log(a(t.data," at pages\\rectificationTaskDetail\\rectificationTaskDetail.vue:185")),e.pictures.push(t.data)})},inpDetail:function(t){this.rectificationBeforeDesc=t.detail.value},confirm:function(){if(0!=this.pictures.length){var e={rectificationBeforeDesc:this.rectificationBeforeDesc,id:this.taskDetail.id,taskStatus:100,rectificationPhoto:this.pictures.join(";")};o.default.rectificationTaskDetail(e),t.showLoading({mask:!0}),setTimeout(function(){t.hideLoading(),t.navigateBack(),t.$emit("refreshTasksPage",!0)},500)}else t.showToast({icon:"none",title:"请拍照上传！"})},cancel:function(){t.navigateBack({}),t.$emit("refreshTasksPage",!1)}}};e.default=u}).call(this,i("6e42")["default"],i("0de9")["default"])}},[["ef4d","common/runtime","common/vendor"]]]);