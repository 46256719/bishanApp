(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/completeTask/completeTask"],{"1d7b":function(t,e,a){},"2a45":function(t,e,a){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=u(a("c0ea")),i=u(a("2a75")),s=a("196c");function u(t){return t&&t.__esModule?t:{default:t}}var c={data:function(){return{taskInfo:{},pictures:[],longitude:"",latitude:"",remark:"",covers:[],circles:[]}},onLoad:function(){},onReady:function(){var e=t.createMapContext("completeMap"),a=e.$getAppMap();a.showUserLocation(!0),this.userInfo=t.getStorageSync("userInfo"),this.taskInfo=i.default.pollutionInfo,console.log(n(this.taskInfo.longitude," at pages\\completeTask\\completeTask.vue:51"));var o=s.mapTool.wgs84togcj02(this.taskInfo.longitude,this.taskInfo.latitude);this.longitude=o[0],this.latitude=o[1],this.initMap(this.taskInfo)},methods:{initMap:function(t){var e=s.mapTool.wgs84togcj02(t.longitude,t.latitude);this.circles=[{latitude:e[1],longitude:e[0],radius:t.distanceLimit,color:"#5087FB80",fillColor:"#5087FB30",strokeWidth:"2"}],this.covers=[{id:"person1",latitude:e[1],longitude:e[0],iconPath:"../../static/images/dingwei.png"}]},getDistance:function(e){var a=this,n=new plus.maps.Point(t.getStorageSync("userLocation").longitude,t.getStorageSync("userLocation").latitude),o=new plus.maps.Point(this.taskInfo.longitude,this.taskInfo.latitude);plus.maps.Map.calculateDistance(n,o,function(n){n.distance>a.taskInfo.distanceLimit&&1==a.taskInfo.mustInRange?t.showToast({icon:"none",title:"距离任务地点太远，无法完成！"}):a.confirm(e)})},chooseTown:function(t){console.log(n(t," at pages\\completeTask\\completeTask.vue:92")),this.on_town=t.detail.value},delPicture:function(t){var e=this.pictures;e.splice(t,1),this.pictures=e},takingPictures:function(){var e=this;t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["camera"],success:function(t){console.log(n(t," at pages\\completeTask\\completeTask.vue:107")),e.pictures.push(t.tempFilePaths[0])}})},getImgUrl:function(t){var e=this;i.default.uploadFile(o.default.UPLOAD_UPLOAD,t,function(t){console.log(n(t," at pages\\completeTask\\completeTask.vue:114")),e.pictures.push(JSON.parse(t).data)})},getRemark:function(t){this.remark=t.detail.value},changeStatus:function(){i.default.getRequest(o.default.TASK_PATROL_POINT_NORMAL,{id:this.taskInfo.id,status:"100"},function(e){i.default.showSuccess("完成",function(){t.navigateBack({})})})},cancel:function(){t.navigateBack({})},confirm:function(e){if(0!=this.pictures.length){var a={id:e.id,longitude:this.longitude,latitude:this.latitude,remark:this.remark,pointPhoto:this.pictures.join(";"),z:1};i.default.completeTask(a),t.showLoading({mask:!0}),setTimeout(function(){t.hideLoading(),t.$emit("refreshPollutionPage",!0),t.navigateBack()},500)}else t.showToast({icon:"none",title:"请拍照上传！"})}}};e.default=c}).call(this,a("6e42")["default"],a("0de9")["default"])},3663:function(t,e,a){"use strict";a.r(e);var n=a("2a45"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},4611:function(t,e,a){"use strict";a.r(e);var n=a("b0ca"),o=a("3663");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("cda2");var s=a("2877"),u=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,"a61ac5aa",null);e["default"]=u.exports},b0ca:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},cda2:function(t,e,a){"use strict";var n=a("1d7b"),o=a.n(n);o.a}},[["ba99","common/runtime","common/vendor"]]]);